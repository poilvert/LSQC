

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Tutorial &mdash; LSQC v1.0 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="LSQC v1.0 documentation" href="index.html" />
    <link rel="next" title="constraints" href="utilities/constraints.html" />
    <link rel="prev" title="Main programs documentation" href="main_program_documentation.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="utilities/constraints.html" title="constraints"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="main_program_documentation.html" title="Main programs documentation"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">LSQC v1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="tutorial">
<h1>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h1>
<blockquote>
<p>The user will be walked through a complete example to show how to use the main programs and <em>hopefully</em>
easily compute the Quantum Conductance of a Large Scale system from a single <strong>LCR</strong>-type calculation
with <a class="reference external" href="http://www.wannier.org">Wannier90</a>.</p>
<p>We will be studying a (3,3) Carbon Nanotube (Armchair-type Carbon Nanotube) with a single Hydrogen defect
functionalized on one of the sidewall carbon atom as shown on the figure below.</p>
</blockquote>
<a class="reference internal image-reference" href="_images/cnt33H_side_view.png"><div align="center" class="align-center"><img alt="_images/cnt33H_side_view.png" class="align-center" src="_images/cnt33H_side_view.png" style="width: 505.2px; height: 122.4px;" /></div>
</a>
<div class="section" id="quantum-conductance-of-a-3-3-cnt-with-a-single-h-defect">
<h2>Quantum Conductance of a (3,3) CNT with a single H defect<a class="headerlink" href="#quantum-conductance-of-a-3-3-cnt-with-a-single-h-defect" title="Permalink to this headline">¶</a></h2>
<blockquote>
<p>Before to even start using this package and any of the main programs, we need first to compute the Wannier
Functions and express the full Hamiltonian matrix (left lead, central region, right lead and connection
matrices) in the Wannier Function basis.</p>
<p>For this we will be using the PWscf code from the <a class="reference external" href="http://www.quantum-espresso.org/">QUANTUM-ESPRESSO</a> distribution. What we need for computing
the Wannier Functions are the following input files :</p>
<blockquote>
<ul class="simple">
<li>an input file <cite>scf.in</cite> for computing the electronic <strong>ground state</strong> of the system (Γ-point calculation)</li>
<li>an input file <cite>nscf.in</cite> for computing the necessary amount of <strong>bands</strong> at Γ</li>
<li>an input file <cite>pw2wannier90.in</cite> for computing the required <strong>Amn</strong> and <strong>Mmn</strong> matrices (needed by the <a class="reference external" href="http://www.wannier.org">Wannier90</a> code
for computing the Wannier Functions later on)</li>
<li>an input file <cite>cnt33H.win</cite> which corresponds to the <a class="reference external" href="http://www.wannier.org">Wannier90</a> master input file</li>
</ul>
</blockquote>
<dl class="docutils">
<dt>The necessary input files are given below :</dt>
<dd><ul class="first last simple">
<li><a class="reference download internal" href="_downloads/scf.in"><tt class="xref download docutils literal"><span class="pre">scf.in</span></tt></a></li>
<li><a class="reference download internal" href="_downloads/nscf.in"><tt class="xref download docutils literal"><span class="pre">nscf.in</span></tt></a></li>
<li><a class="reference download internal" href="_downloads/pw2wannier90.in"><tt class="xref download docutils literal"><span class="pre">pw2wannier90.in</span></tt></a></li>
<li><a class="reference download internal" href="_downloads/cnt33H.win"><tt class="xref download docutils literal"><span class="pre">cnt33H.win</span></tt></a></li>
</ul>
</dd>
</dl>
<p>In order to compute the Wannier Functions for that defected nanotube, follow the following steps:</p>
<blockquote>
<ol class="arabic">
<li><dl class="first docutils">
<dt>First compute the Ground State of the system with PWscf (We assume the user knows how to use PWscf)</dt>
<dd><p class="first last"><tt class="docutils literal"><span class="pre">pw.x</span> <span class="pre">&lt;</span> <span class="pre">scf.in</span> <span class="pre">&gt;</span> <span class="pre">scf.out</span></tt></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Then run the Band calculation with:</dt>
<dd><p class="first last"><tt class="docutils literal"><span class="pre">pw.x</span> <span class="pre">&lt;</span> <span class="pre">nscf.in</span> <span class="pre">&gt;</span> <span class="pre">nscf.out</span></tt></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Now we need to run <a class="reference external" href="http://www.wannier.org">Wannier90</a> as a post-processing in order to generate the <cite>cnt33H.nnkp</cite> file:</dt>
<dd><p class="first last"><tt class="docutils literal"><span class="pre">wannier90.x</span> <span class="pre">-pp</span> <span class="pre">cnt33H</span></tt></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>We then compute the Amn and Mmn matrices with pw2wannier90:</dt>
<dd><p class="first last"><tt class="docutils literal"><span class="pre">pw2wannier90.x</span> <span class="pre">&lt;</span> <span class="pre">pw2wannier90.in</span> <span class="pre">&gt;</span> <span class="pre">pw2wannier90.out</span></tt></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>At last we generate the Wannier Functions of the system with <a class="reference external" href="http://www.wannier.org">Wannier90</a>:</dt>
<dd><p class="first last"><tt class="docutils literal"><span class="pre">wannier90.x</span> <span class="pre">cnt33H</span></tt></p>
</dd>
</dl>
</li>
</ol>
</blockquote>
<p>If everything runs smoothly, the user should end up with a nicely converged set of Wannier Functions (look
at the <cite>cnt33H.wout</cite> file for this). The next step is to run the <strong>LCR</strong> Quantum Conductance calculation
by following those steps:</p>
<blockquote>
<ol class="arabic">
<li><p class="first">Uncomment the lines in <cite>cnt33H.win</cite> starting with a <cite>#</cite> symbols (everything concerning transport)</p>
</li>
<li><dl class="first docutils">
<dt>Re-run <a class="reference external" href="http://www.wannier.org">Wannier90</a> again:</dt>
<dd><p class="first last"><tt class="docutils literal"><span class="pre">wannier90.x</span> <span class="pre">cnt33H</span></tt></p>
</dd>
</dl>
</li>
</ol>
</blockquote>
<dl class="docutils">
<dt>Normally, the code should exit without errors and produce many new files. Those files are:</dt>
<dd><ul class="first last simple">
<li><cite>cnt33H_dos.dat</cite></li>
<li><cite>cnt33H_qc.dat</cite></li>
<li><cite>cnt33H_htL.dat</cite>, <cite>cnt33H_htLC.dat</cite>, <cite>cnt33H_htC.dat</cite>, <cite>cnt33H_htCR.dat</cite>, <cite>cnt33H_htR.dat</cite></li>
<li><cite>cnt33H_tran_info.dat</cite></li>
</ul>
</dd>
</dl>
</blockquote>
</div>
<div class="section" id="using-the-lsqc-package-to-generate-a-large-scale-structure">
<h2>Using the LSQC package to generate a large scale structure<a class="headerlink" href="#using-the-lsqc-package-to-generate-a-large-scale-structure" title="Permalink to this headline">¶</a></h2>
<blockquote>
Now that we have computed all the needed matrices, we will be in a position to use the main programs and play
around with these matrices. The user will be shown how to use the programs to generate a Large Scale structure and compute
its Quantum Conductance.</blockquote>
<p><strong>Visualizing the influence of the defect</strong></p>
<blockquote>
<p>First let us visualize how the Hydrogen defect impacts the &#8220;on-site&#8221; matrix elements for each Wannier Functions.
To this end we will be using <cite>visualize_defect_influence.py</cite>. Moving to the directory that contains the file <cite>cnt33H_tran_info.dat</cite>
we execute the following command in a terminal:</p>
<blockquote>
<tt class="docutils literal"><span class="pre">python</span> <span class="pre">/path/to/visualize_defect_influence.py</span> <span class="pre">-f</span> <span class="pre">cnt33H_tran_info.dat</span></tt></blockquote>
<p>The user should of course replace <tt class="docutils literal"><span class="pre">/path/to/visualize_defect_influence.py</span></tt> by the actual path to the program <cite>visualize_defect_influence.py</cite>
on his/her computer. One then can save the image with <a class="reference external" href="http://code.enthought.com/projects/mayavi/">Mayavi</a> and obtain the picture below:</p>
</blockquote>
<a class="reference internal image-reference" href="_images/H_influence.png"><div align="center" class="align-center"><img alt="_images/H_influence.png" class="align-center" src="_images/H_influence.png" style="width: 688.5px; height: 346.5px;" /></div>
</a>
<blockquote>
The white semi-transparent balls represent the atoms in the nanotube. The colored balls with different sizes represent the &#8220;on-site&#8221;
matrix elements. The larger the size of the ball the more deviation in the matrix element from the left-most reference unit cell
there is. As we can see, the Hydrogen defect really perturbs the Wannier Functions around it but beyond a few chemical bonds from
the defect, the deviations go quickly to zero. This allows us to determine that, <em>a priori</em>, one can get as close as one unit cell
away from the defect (on both sides) without &#8220;feeling&#8221; the infuence of the defect too much.</blockquote>
<p><strong>Generating rotationally equivalent conductor matrices</strong></p>
<blockquote>
As one can easily realize by inspecting the structures, the lead part of the nanotube possesses a <img class="math" src="_images/math/3a1f43766bf2f5511df35ab6d4a0b84dbcb6dadb.png" alt="\frac{2\pi}{3}"/> rotational symmetry
about its axis. This symmetry is shown below by looking at the 3 rotated equivalent structures along the nanotube axis.</blockquote>
<a class="reference internal image-reference" href="_images/rotated_equivalents.png"><div align="center" class="align-center"><img alt="_images/rotated_equivalents.png" class="align-center" src="_images/rotated_equivalents.png" style="width: 384.0px; height: 126.0px;" /></div>
</a>
<blockquote>
<p>In order to generate the Hamiltonian matrices for the 120-degre and 240-degre rotated systems, we will use <cite>rotate_conductor.py</cite>.
The use is quite simple and all we need to know is how many radians is 120 degres (~2.09439510239):</p>
<blockquote>
<tt class="docutils literal"><span class="pre">python</span> <span class="pre">/path/to/rotate_conductor.py</span> <span class="pre">-f</span> <span class="pre">cnt33H_tran_info.dat</span> <span class="pre">-m</span> <span class="pre">cnt33H_htC.dat</span> <span class="pre">-a</span> <span class="pre">2.09439510239</span></tt></blockquote>
<p>This command will produce a file called <cite>rotated_matrix_htC.dat</cite> that we will rename <cite>cnt33H_120_htC.dat</cite> because it corresponds to
the <img class="math" src="_images/math/3a1f43766bf2f5511df35ab6d4a0b84dbcb6dadb.png" alt="\frac{2\pi}{3}"/> rotated system. In analogy to the above procedure, we can easily produce the Hamiltonian matrix corresponding to
the <img class="math" src="_images/math/6ecf0a74d8b619f5c498690e17e1252ce0a17de1.png" alt="\frac{4\pi}{3}"/> rotated system (that we will call <cite>cnt33H_240_htC.dat</cite>).</p>
</blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The program will also re-generate a *_tran_info.dat file because the structure has been changed (atoms have been rotated). The user
is urged to use this <strong>new</strong> *_tran_info.dat file for all subsequent calculations on the &#8220;rotated&#8221; system. We will call
<strong>cnt33H_120_tran_info.dat</strong> and <strong>cnt33H_240_tran_info.dat</strong> the new *_tran_info.dat files for respectively the 120-degre and
240-degre rotated systems.</p>
</div>
<p><strong>Generating translationally inequivalent conductor matrices</strong></p>
<blockquote>
<p>Now that the 3 rotationally equivalent matrices have been obtained, we will make use of our findings at step 1. Indeed we saw that
the influence of the Hydrogen defect was local and so we could easily imagine &#8220;chopping&#8221; off some lead unit cells on both side of
the defect without destroying the transferability of the conductor matrix. The reason for doing so is to increase the defect density
along the nanotube axis, when at the final step, we will combine those matrices together to produce a Large Scale structure. For this
task we will make use of <cite>cut_conductor.py</cite>:</p>
<blockquote>
<tt class="docutils literal"><span class="pre">python</span> <span class="pre">/path/to/cut_conductor.py</span> <span class="pre">-f</span> <span class="pre">cnt33H_tran_info.dat</span> <span class="pre">-m</span> <span class="pre">cnt33H_htC.dat</span> <span class="pre">-a</span></tt></blockquote>
<p>This piece of code will output something similar to the following on screen:</p>
<div class="highlight-python"><pre>[prompt] python /path/to/cut_conductor.py -f cnt33H_tran_info.dat -m cnt33H_htC.dat -a

          LARGE SCALE QUANTUM CONDUCTANCE PACKAGE
          Nicolas Poilvert

program cut_conductor.py
program started on Tuesday, 15 June 2010 at 04:26:42

Reading ../conformation_1/cnt33H_1_tran_info.dat : 100% [##########################] Time: 00:00:00
Loading matrix : 100% [############################################################] Time: 00:00:00

Number of left  cells to remove in the conductor : 1

Number of right cells to remove in the conductor : 1

Writing matrix to file : 100% [####################################################] Time: 00:00:00
Writing matrix to file : 100% [####################################################] Time: 00:00:00
Writing matrix to file : 100% [####################################################] Time: 00:00:00
Writing matrix to file : 100% [####################################################] Time: 00:00:00

Execution time :   3.25 s</pre>
</div>
<p>The <strong>user</strong> has to enter the number of <strong>left</strong> and <strong>right</strong> unit cells that are going to be &#8220;chopped&#8221; off from the Hamiltonian matrix.
The user ends up with a set of directories corresponding to every possible cutting scheme (in this case, we can only cut at most 1 unit
cell on both sides which leads to 2*2 = 4 different matrices). After this step, the user still has to follow the same procedure for the
other 2 rotated equivalent matrices:</p>
<blockquote>
<p><tt class="docutils literal"><span class="pre">python</span> <span class="pre">/path/to/cut_conductor.py</span> <span class="pre">-f</span> <span class="pre">cnt33H_120_tran_info.dat</span> <span class="pre">-m</span> <span class="pre">cnt33H_120_htC.dat</span></tt></p>
<p><tt class="docutils literal"><span class="pre">python</span> <span class="pre">/path/to/cut_conductor.py</span> <span class="pre">-f</span> <span class="pre">cnt33H_240_tran_info.dat</span> <span class="pre">-m</span> <span class="pre">cnt33H_120_htC.dat</span></tt></p>
</blockquote>
</blockquote>
<p><strong>Building a Large Scale structure</strong></p>
<blockquote>
<p>We are now all set for building a <strong>random</strong> or <strong>custom</strong> Large Scale structure from our &#8220;building blocks&#8221;. The program allowing us
to do such a thing is <cite>system_builder.py</cite>.</p>
<p>First let us gather all the directories generated at the previous steps into one and let us call this directory <cite>building_blocks</cite>.
Your directory should then contain 12 subdirectories as shown below:</p>
<div class="highlight-python"><pre>[prompt] ls building_blocks/
0_left_0_right_0d  0_left_0_right_120d  0_left_0_right_240d
0_left_1_right_0d  0_left_1_right_120d  0_left_1_right_240d
1_left_0_right_0d  1_left_0_right_120d  1_left_0_right_240d
1_left_1_right_0d  1_left_1_right_120d  1_left_1_right_240d</pre>
</div>
<p>We have one <strong>last</strong> step <strong>before to generate a structure</strong>. We need a matrix that will play the role of a <em>pristine lead</em>. Luckily
the user has nothing to do since that matrix is <strong>readily available</strong> from the <a class="reference external" href="http://www.wannier.org">Wannier90</a> code. Indeed the <em>cnt33H_htL.dat</em> matrix
already correspond to such a lead matrix. So let us create a <strong>lead/</strong> directory and copy <em>cnt33H_htL.dat</em> in it <strong>remembering</strong> to
<strong>change</strong> the name into <em>cnt33H_htC.dat</em> (this is a requirement from the program <cite>system_builder.py</cite>).</p>
<p>Let us now generate a <strong>random</strong> structure with 5 defects by typing:</p>
<blockquote>
<tt class="docutils literal"><span class="pre">python</span> <span class="pre">/path/to/system_builder.py</span> <span class="pre">-r</span></tt></blockquote>
<p>The program will then ask you a few questions concerning the system. The output should look like this:</p>
<div class="highlight-python"><pre>[prompt] python /path/to/system_builder.py -r

          LARGE SCALE QUANTUM CONDUCTANCE PACKAGE
          Nicolas Poilvert

program system_builder.py
program started on Wednesday, 16 June 2010 at 04:17:58

The program found the following defects :
                              1_left_0_right_240d                                 0_left_1_right_0d
                              0_left_1_right_240d                               0_left_0_right_120d
                                1_left_1_right_0d                                              lead
                              1_left_0_right_120d                                 0_left_0_right_0d
                              1_left_1_right_240d                                 1_left_0_right_0d
                              0_left_0_right_240d                               0_left_1_right_120d
                              1_left_1_right_120d

which defect represents the lead : lead

how many defects in the system : 5
Loading matrix : 100% [############################################################] Time: 00:00:00
Loading matrix : 100% [############################################################] Time: 00:00:00
Loading matrix : 100% [############################################################] Time: 00:00:00
Loading matrix : 100% [############################################################] Time: 00:00:00
Loading matrix : 100% [############################################################] Time: 00:00:00

how many unit cells in one principal layer : 3

how many buffer unit cells between defects : 0
Writing matrix to file : 100% [####################################################] Time: 00:00:02

Time to build matrix    :      10.61 s</pre>
</div>
<p>The program starts by asking what the lead matrix will be. In our case, this is simply <cite>lead</cite>. After that the program wants to know
how many lead unit cells there is in <strong>one</strong> principal layer. In our case it is 3 (this should correspond to the number in the original
*_tran_info.dat file, line 3). At last, the code gives the user the possibility to insert lead unit cells between each defect. In our
case we chose 0.</p>
<p>If one looks at the content of the directory <cite>building_blocks/</cite> there should be one new directory called <strong>random_system</strong>:</p>
<div class="highlight-python"><pre>[prompt] ls building_blocks/
0_left_0_right_0d  0_left_0_right_120d  0_left_0_right_240d
0_left_1_right_0d  0_left_1_right_120d  0_left_1_right_240d
1_left_0_right_0d  1_left_0_right_120d  1_left_0_right_240d
1_left_1_right_0d  1_left_1_right_120d  1_left_1_right_240d
lead               random_system</pre>
</div>
<p>Moving into this directory <tt class="docutils literal"><span class="pre">cd</span> <span class="pre">random_system/</span></tt>, we can directly start a <a class="reference external" href="http://www.wannier.org">Wannier90</a> calculation from there:</p>
<blockquote>
<tt class="docutils literal"><span class="pre">wannier90.x</span> <span class="pre">random_system</span></tt></blockquote>
<p>The computed Quantum Conductance of this 5-defect system is shown on the figure below.</p>
</blockquote>
<a class="reference internal image-reference" href="_images/random_QC.png"><div align="center" class="align-center"><img alt="_images/random_QC.png" class="align-center" src="_images/random_QC.png" style="width: 594.0px; height: 459.0px;" /></div>
</a>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Tutorial</a><ul>
<li><a class="reference internal" href="#quantum-conductance-of-a-3-3-cnt-with-a-single-h-defect">Quantum Conductance of a (3,3) CNT with a single H defect</a></li>
<li><a class="reference internal" href="#using-the-lsqc-package-to-generate-a-large-scale-structure">Using the LSQC package to generate a large scale structure</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="main_program_documentation.html"
                        title="previous chapter">Main programs documentation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="utilities/constraints.html"
                        title="next chapter"><tt class="docutils literal"><span class="pre">constraints</span></tt></a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/tutorial.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="utilities/constraints.html" title="constraints"
             >next</a> |</li>
        <li class="right" >
          <a href="main_program_documentation.html" title="Main programs documentation"
             >previous</a> |</li>
        <li><a href="index.html">LSQC v1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2010, Nicolas Poilvert.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0b2.
    </div>
  </body>
</html>